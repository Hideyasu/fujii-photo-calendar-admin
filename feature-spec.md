# 機能仕様定義

## 機能名

藤井写真館 写真管理システム（Admin 側）

## 概要

藤井写真館の管理者が、顧客の写真を管理し、カレンダー × デジタルフォトフレームアプリ（クライアント側）と連携して継続的な来店を促進するための管理システム。Firebase 認証を使用し、顧客情報の管理、写真のアップロード・管理、キャンペーン配信などを行う。

## ユーザーストーリー

### メインストーリー

- **誰が**: 藤井写真館のスタッフ（管理者）
- **何を**: 顧客の写真を効率的に管理し、アプリを通じて配信したい
- **なぜ**: 顧客の継続的な来店を促進し、写真館の利用率を向上させるため

### 使用シナリオ

1. 撮影後、管理者が顧客情報を登録し、撮影した写真を一括アップロード
2. 写真に撮影日やタイトルを設定し、顧客のアカウントに紐付け
3. 定期的にキャンペーン情報を配信し、再来店を促進
4. 顧客の利用状況を確認し、フォローアップを実施

## 機能要件

### 必須要件

- [ ] **認証機能**: Firebase Authentication による管理者認証
- [ ] **写真アップロード**: 複数写真の一括アップロード（ドラッグ&ドロップ対応）
- [ ] **写真メタデータ管理**: 撮影日、タイトル、メモの設定
- [ ] **写真と顧客の紐付け**: アップロードした写真を特定の顧客に関連付け
- [ ] **写真削除機能**: 不要な写真の削除

### オプション要件

- [ ] **統計ダッシュボード**: 顧客の利用状況、写真閲覧数の可視化
- [ ] **一括操作**: 複数顧客への写真一括配信
- [ ] **バックアップ機能**: 写真データの定期バックアップ
- [ ] **閲覧者管理**: 祖父母など閲覧者の情報管理

## 受け入れ条件

### 正常系

- **前提条件**: 管理者としてログイン済み
- **操作**: 写真を選択し、顧客 A に紐付けてアップロード
- **期待結果**:
  - 写真が Firebase Storage に保存される

### 異常系/エッジケース

- **エラーケース 1**: 大容量ファイル（10MB 以上）のアップロード時は圧縮処理を実行
- **エラーケース 2**: 顧客未選択での写真アップロードはできないようにする

## データ/エンティティ

### 主要なデータ

- **User（顧客）**:
  - ID、名前、メールアドレス、電話番号
  - ロール（admin/user）
  - 登録日、最終来店日
- **Photo（写真）**:
  - ID、URL、撮影日、アップロード日
  - タイトル、メモ、サイズ
  - 顧客 ID（紐付け）、表示優先度
- **Campaign（キャンペーン）**:
  - ID、タイトル、内容
  - 開始日、終了日、対象顧客

### データの関係性

- 1 人の顧客に対して複数の写真を紐付け（1:N）
- 1 つのキャンペーンは複数の顧客に配信（1:N）
- 顧客は複数の閲覧者を持つ（1:N）

## 制約事項

### ビジネス制約

- 顧客の個人情報保護の徹底
- 写真の著作権は藤井写真館に帰属

### 技術制約

- Firebase の利用（Authentication, Firestore, Storage）
- Web ベースのレスポンシブ対応
- 画像形式：JPEG, PNG, HEIF 対応
- 最大アップロードサイズ：50MB/ファイル

## 成功指標

- 管理者の写真アップロード作業時間を 50%削減
- 顧客の再来店率を 30%向上
- システム稼働率 99.9%以上
- 写真アップロードから顧客通知まで 1 分以内

## 備考

- 将来的に AI 機能（顔認識による自動タグ付けなど）の追加を検討
